<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pvp Game List</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" th:href="@{/css/fragments.css}" />
  <link rel="icon" type="image/png" sizes="16x16" href="/images/SA-Flare.png">

  <style>
    h1 {
      color: #0d6efd;
      margin-bottom: 2rem;
      text-align: center;
    }
    .badge-waiting {
      background-color: #ffc107;
      color: #212529;
    }
    .badge-full {
      background-color: #198754;
    }
    .badge-in_game {
      background-color: #dc3545;
    }
    tbody tr:hover {
      cursor: pointer;
      background-color: #e9ecef;
    }
  </style>
</head>
<body>

<div th:insert="~{fragments/header :: header}"></div>
<div th:replace="~{fragments/sidebar :: sidebar}"></div>


    <div class="container">
          <h1>Active Pvp Games</h1>
          <div class="mt-5">
              <a href="/pvp/new" class="btn btn-primary mt-3">New PvP Game</a>
          </div>

    <div class="table-responsive">
          <table class="table table-striped table-hover align-middle">
              <thead class="table-primary">
                  <tr>
                      <th scope="col">Pvp Game ID</th>
                      <th scope="col">User 1 ID</th>
                      <th scope="col">User 2 ID</th>
                      <th scope="col">Status</th>
                      <th scope="col">Created At</th>
                      <th scope="col">Play?</th>
                  </tr>
              </thead>
          <tbody>

          <tr th:each="pvpGame : ${pvpGames}" th:if="${pvpGames.size() > 0}">
                  <td th:text="${pvpGame.id}">1</td>
                  <td th:text="${pvpGame.playerOneId != null ? pvpGame.playerOneId : '-'}">User1</td>
                  <td th:text="${pvpGame.playerTwoId != null ? pvpGame.playerTwoId : '-'}">User2</td>
                  <td>
                        <span class="badge"
                              th:classappend="${pvpGame.status == 'WAITING'} ? ' badge-waiting' :
                                              (${pvpGame.status == 'FULL'} ? ' badge-full' :
                                              (${pvpGame.status == 'IN_GAME'} ? ' badge-in_game' : ' badge-secondary'))"
                              th:text="${pvpGame.status}">WAITING</span>
                  </td>
                  <td th:text="${#temporals.format(pvpGame.createdAt, 'yyyy-MM-dd HH:mm')}">2025-06-24 12:00</td>
                  <td>
                        <form th:action="@{/pvp/join}" method="post" style="display:inline;" th:if="${pvpGame.status == 'WAITING'}">
                              <input type="hidden" name="pvpGameId" th:value="${pvpGame.id}"/>
                                <button type="submit" class="text-decoration-none text-reset">Join!</button>
                        </form>
                  </td>
            </tr>
        </tbody>
      </table>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<div th:insert="~{fragments/footer :: footer}"></div>
<div th:insert="~{fragments/tutorial :: tutorialModal}"></div>
</body>
</html>
